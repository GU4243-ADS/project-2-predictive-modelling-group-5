---
title: "R Notebook"
output: html_notebook
---

# CV and predtic/test error with best model

```{r}
######## Required packages
#library(RcppCNPy)

label_train <- "/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/Pet Images and Extracted Features - Project 2/train_label.txt"
label <- read.table(label_train, header = F)
label <- as.numeric(unlist(label) == "dog")
label_train <- as.matrix(label)
colnames(label_train) <- "labels"
 
# Notes which file I am uploading!!!! 
load("/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/GitHub/project-2-predictive-modelling-group-5/output/feature_ORB_randompets_n60.RData")
ORB <- dat

#remember to train.y value in as.factor(). Without as.factor the svm() function will do regression and give very different (continuous) outputs
cv.duration.noah.ORB.1000 <- system.time(cv.output.noah.ORB.1000 <- tune(svm, train.x = ORB[1:1000,], train.y = as.factor(label_train[1:1000,]), kernel = "linear", scale = FALSE, ranges = list(cost=c(.00000001, .00001, 0.001,0.01, 1, 5)), tunecontrol = tune.control(cross = 5)))
cv.duration.noah.ORB.1000

summary(cv.output.noah.ORB.1000)

best_svm_model.noah.ORB.1000 <- list(fit = cv.output.noah.ORB.1000$best.model)
summary(best_svm_model.noah.ORB.1000$fit)

pred_test.noah.ORB.1000 <- test_SVM(best_svm_model.noah.ORB.1000, ORB[1001:2000,])
comparison_chart.noah.ORB.1000 <- table(predict=pred_test.noah.ORB.1000, truth=label_train[1001:2000,])
chart <- comparison_chart.noah.ORB.1000
misclass <- sum(chart[1,2],chart[2,1])
test_error.noah.ORB.1000 <- misclass/length(pred_test.noah.ORB.1000)
test_error.noah.ORB.1000

```


# Train ORB + SVM on 1600 files

```{r}
#Chosen value of cost = ?????

label_train <- "/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/Pet Images and Extracted Features - Project 2/train_label.txt"
label <- read.table(label_train, header = F)
label <- as.numeric(unlist(label) == "dog")
label_train <- as.matrix(label)
colnames(label_train) <- "labels"

# Notes which file I am uploading!!!!
load("/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/GitHub/project-2-predictive-modelling-group-5/output/feature_ORB_randompets_n60.RData")
ORB <- dat

# Remember to set par!!!!
source("../doc/train_SVM.R")
train.duration.noah.ORB.1600 <- system.time(fit_train.noah.ORB.1600 <- train_SVM(ORB[1:1600,], label_train[1:1600,], par = 0.00001))
train.duration.noah.ORB.1600


summary(fit_train.noah.ORB.1600$fit)

source("../doc/test_SVM.R")
test.duration.noah.ORB.400 <- system.time(pred_test.noah.ORB.400 <- test_SVM(fit_train.noah.ORB.1600, ORB[1601:2000,]))
comparison_chart.noah.ORB.400 <- table(predict=pred_test.noah.ORB.400, truth=label_train[1601:2000,])
chart <- comparison_chart.noah.ORB.400
misclass <- sum(chart[1,2],chart[2,1])
test_error.noah.ORB.400 <- misclass/length(pred_test.noah.ORB.400)
test_error.noah.ORB.400



test.duration.noah.ORB.400



```


```{r}

```

