---
title: "R Notebook"
output: html_notebook
---
```{r}
######## Required packages
#library(e1071)

###### CV and predtic/test error with best model


label_train <- "/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/Pet Images and Extracted Features - Project 2/train_label.txt"
label <- read.table(label_train, header = F)
label <- as.numeric(unlist(label) == "dog")
label_train <- as.matrix(label)
colnames(label_train) <- "labels"
  
load("/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/GitHub/project-2-predictive-modelling-group-5/output/feature_hog_train.RData")
hog_train <- dat
load("/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/GitHub/project-2-predictive-modelling-group-5/output/feature_hog_test.RData")
hog_test <- dat
hog <- rbind(hog_train, hog_test)

#remeber to train.y value in as.factor(). Without as.factor the svm() function will do regression and give very different (continuous) outputs
#added scale=FALSE as input
cv.duration.hog.svm.1000 <- system.time(cv.output.hog.svm.1000 <- tune(svm, train.x = hog[1:1000,], train.y = as.factor(label_train[1:1000,]), kernel = "linear", scale=FALSE, ranges = list(cost=c(.00000001, .0000001, .000001, .00001, 0.0001, 0.001, 0.01)), tunecontrol = tune.control(cross = 5)))
cv.duration.hog.svm.1000
#user  system elapsed 
#15.650   1.749  17.426 


summary(cv.output.hog.svm.1000)

best_svm_model.hog.svm.1000 <- list(fit = cv.output.hog.svm.1000$best.model)
summary(best_svm_model.hog.svm.1000$fit)

pred_test.hog.svm.1000 <- test_SVM(best_svm_model.hog.svm.1000, hog[1001:2000,])
comparison_chart.hog.svm.1000 <- table(predict=pred_test.hog.svm.1000, truth=label_train[1001:2000,])
chart <- comparison_chart.hog.svm.1000
misclass <- sum(chart[1,2],chart[2,1])
test_error.hog.svm.1000 <- misclass/length(pred_test.hog.svm.1000)
test_error.hog.svm.1000
#0.318
```


# Train Ginny + SVM on 1600 files

```{r}
#Chosen value of cost = 0.00000001

label_train <- "/Users/admin/Desktop/Columbia/Spring 2018/Applied DS/Pet Images and Extracted Features - Project 2/train_label.txt"
label <- read.table(label_train, header = F)
label <- as.numeric(unlist(label) == "dog")
label_train <- as.matrix(label)
colnames(label_train) <- "labels"

hog

source("../doc/train_SVM.R")
train.duration.hog.svm.1600 <- system.time(fit_train.hog.svm.1600 <- train_SVM(hog[1:1600,], label_train[1:1600,], par = 0.10))
train.duration.hog.svm.1600
#user  system elapsed 
#0.859   0.121   0.991  

summary(fit_train.hog.svm.1600$fit)

source("../doc/test_SVM.R")
test.duration.hog.svm.400 <- system.time(pred_test.hog.svm.400 <- test_SVM(fit_train.hog.svm.1600, hog[1601:2000,]))
comparison_chart.hog.svm.400 <- table(predict=pred_test.hog.svm.400, truth=label_train[1601:2000,])
chart <- comparison_chart.hog.svm.400
misclass <- sum(chart[1,2],chart[2,1])
test_error.hog.svm.400 <- misclass/length(pred_test.hog.svm.400)
test_error.hog.svm.400
# 0.3225
test.duration.ginny.svm.400
#  user  system elapsed 
#  1.228   0.042   1.272  


```


```{r}

```

